import pydicom
import shutil
import os
import sys
from datetime import date


def take_off_tag(path):
    today = str(date.today()).replace('-', '')
    print(today)
    for case in os.listdir(path):
        dicom_path = os.path.join(path, case)
        if os.path.isfile(dicom_path):
            print("skip files in case list")
            continue
        print(dicom_path)
        dcms = os.listdir(dicom_path)
        for dcm in dcms:
            if dcm.endswith('.dcm'):
                dicoms = os.path.join(dicom_path, dcm)
                try:
                    ds = pydicom.dcmread(dicoms)
                    ds.StudyDate = today
                    ds.SeriesDate = today
                    ds.AcquisitionDate = today
                    ds.ContentDate = today
                    ds.studyDescription = 'Coronary CTA'
                    ds.save_as(dicoms)
                    print('success change {}'.format(dicoms))
                except Exception as e:
                    print(e)
            else:
                if os.path.isfile(os.path.join(dicom_path, dcm)):
                    os.remove(os.path.join(dicom_path, dcm))
                    print("rmove unused file {}".format(dcm))
                if os.path.isdir(os.path.join(dicom_path, dcm)):
                    shutil.rmtree(os.path.join(dicom_path, dcm))
                    print("rmove unused folder {}".format(dcm))


def get_dicom_info(path):
    for case in os.listdir(path):
        if os.path.isdir(os.path.join(path, case)):
            case_path = os.path.join(path, case)
            for dcm in os.listdir(case_path):
                if 'dcm' in dcm:
                    ds = pydicom.dcmread(os.path.join(case_path, dcm))
                    patientNum = ds.PatientID
                    patientName = ds.PatientName
                    studyDescription = ds.StudyDescription
                    seriesDescription = ds.SeriesDescription
                    studyInstanceId = ds.StudyInstanceUID
                    seriesInstanceId = ds.SeriesInstanceUID
                    with open('products.csv', 'a+')as p:
                        p.write("{}, {}, {}, {}, {}, {}".format(patientNum, patientName, studyDescription, seriesDescription, studyInstanceId, seriesInstanceId))
                    break


def wuhan_studyDate(path):
    import datetime
    dcase = {}
    for case in os.listdir(path):
        if not os.path.isdir(os.path.join(path, case)):
            continue
        if not os.path.exists(os.path.join(path, case, 'slices')):
            continue
        dcms = os.path.join(path, case, 'slices')
        for dcm in os.listdir(dcms):
            if dcm.endswith('.dcm'):
                ds = pydicom.dcmread(os.path.join(dcms, dcm))
                studyDate = ds.StudyDate
                studyTime = ds.StudyTime
                studyDate = datetime.datetime.strptime(studyDate, "%Y%M%d").strftime("%Y/%M/%d")
                studyTime = datetime.datetime.strptime(studyTime, "%H%M%S").strftime("%H:%M:%S")
                dcase[case] = f"{studyDate} {studyTime}"
                break

    print(dcase)


def post_dcms(path):
    import subprocess
    import os
    import sys

    if len(sys.argv) >= 2:
        path = sys.argv[1]
        print(path)

    dir_list = os.listdir(path)
    for case_num in dir_list:
        dcm_path = os.path.join(path, case_num)
        for dcm in (os.listdir(dcm_path)):
            if os.path.isdir(os.path.join(dcm_path, dcm)):
                continue
            if 'jpg' in dcm:
                os.remove(os.path.join(dcm_path, dcm))
            if 'dcm' in dcm:
                cmd = "storescu  -aet Coronary -aec SKDICOMINT 10.10.10.90 11113  +sd '{path}' ".format(
                    path=os.path.join(dcm_path, dcm))
                print(cmd)
                res = subprocess.run(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)
                print(res)


if __name__ == '__main__':
    cases = {'P001520704600T20190516115724R9250': '2019-05-16 11:31:40', 'P001518974700T20190516145221R4520': '2019-05-15 15:06:09', 'P001516570800T20190509155730R2270': '2019-05-09 15:27:56', 'P001518109700T20190514163801R4680': '2019-05-14 16:07:28', 'P001516306900T20190508161545R2960': '2019-05-08 15:48:05', 'P001118264600T20190517084221R2170': '2019-05-17 08:09:22', 'P001516554400T20190509093555R8500': '2019-05-09 09:17:00', 'P001515342500T20190506202425R2660': '2019-05-06 17:08:40', 'P001518763500T20190514110919R7580': '2019-05-14 10:46:09', 'P001516968600T20190509095109R3530': '2019-05-08 15:39:38', 'P001512778500T20190507151153R1580': '2019-05-07 10:46:13', 'P001202478800T20190512092939R2010': '2019-05-12 09:11:58', 'P001520165800T20190521143256R4480': '2019-05-21 14:09:52', 'P001515323700T20190507093747R8970': '2019-05-07 09:20:15', 'P001514738700T20190506201944R3080': '2019-05-06 08:45:37', 'P001519429100T20190516182734R1070': '2019-05-16 17:45:47', 'P001518973800T20190513152321R1600': '2019-05-13 14:51:42', 'P001109708200T20190520100153R1500': '2019-05-20 09:42:25', 'P001518076700T20190513113610R7120': '2019-05-12 10:02:25', 'P001518179300T20190515095641R7450': '2019-05-15 09:36:59', 'P000890312900T20190511083452R9210': '2019-05-10 10:55:37', 'P001518560300T20190515110824R3380': '2019-05-15 10:45:04', 'P001517873400T20190511093130R1570': '2019-05-11 09:14:13', 'P001519183900T20190514091545R4510': '2019-05-14 08:53:59', 'P001520181700T20190517091616R7150': '2019-05-17 08:57:50', 'P001515122600T20190509104216R1650': '2019-05-09 10:13:00', 'P001519728900T20190518114917R5640': '2019-05-18 11:32:19', 'P001516935500T20190522101353R1030': '2019-05-22 09:51:52', 'P001516299500T20190507164633R9770': '2019-05-07 16:13:38', 'P000844170000T20190516113624R4390': '2019-05-16 11:12:11', 'P001515008100T20190511124600R5730': '2019-05-11 12:20:01', 'P001519272200T20190516171231R7470': '2019-05-16 16:50:44', 'P001312795800T20190510115532R4550': '2019-05-10 11:28:47', 'P001518476500T20190514143341R5150': '2019-05-14 14:12:42', 'P001519659200T20190516150505R7440': '2019-05-15 16:21:17', 'P001518457100T20190515092614R6380': '2019-05-15 09:08:57', 'P001516986200T20190509100955R5980': '2019-05-09 09:48:49', 'P001516348000T20190508173802R1970': '2019-05-08 16:46:08', 'P001514946000T20190514182325R1820': '2019-05-14 17:56:42', 'P001520179000T20190521134416R2700': '2019-05-21 11:11:56', 'P001519600600T20190517084550R1750': '2019-05-17 08:21:12', 'P001515887000T20190506160207R2370': '2019-05-06 15:42:23', 'P001517167500T20190509115826R1550': '2019-05-09 11:16:38', 'P001519763200T20190517103516R9210': '2019-05-17 10:12:56', 'P001515746700T20190507182412R3730': '2019-05-07 09:18:42', 'P001519651600T20190518104400R3000': '2019-05-18 10:21:33', 'P001519363100T20190516102610R7510': '2019-05-16 10:08:03', 'P001519503800T20190517084815R6450': '2019-05-17 08:30:19', 'P001517259100T20190520171233R9460': '2019-05-20 16:43:21', 'P000897111800T20190508101709R2880': '2019-05-07 09:59:46', 'P001516525100T20190507151044R4620': '2019-05-07 11:19:58', 'P001516835900T20190510160800R1200': '2019-05-10 15:40:34', 'P001518697500T20190513150922R4380': '2019-05-13 14:46:11', 'P001516838400T20190508161125R8230': '2019-05-08 11:45:25', 'P001519815000T20190516182917R8920': '2019-05-16 17:55:21', 'P001516219200T20190507093541R4870': '2019-05-07 09:13:32', 'P001515780800T20190509084715R5340': '2019-05-09 08:23:53', 'P001517162400T20190515095758R5080': '2019-05-15 09:37:21', 'P001520205000T20190517174523R7900': '2019-05-17 17:20:32', 'P001509376100T20190508101803R3110': '2019-05-07 10:16:28', 'P001210919200T20190506170246R6890': '2019-05-06 16:38:51', 'P001514166600T20190518110608R5710': '2019-05-17 08:51:00', 'P001519711700T20190517150643R5800': '2019-05-17 14:45:38', 'P001519691300T20190520100745R7080': '2019-05-20 09:46:57', 'P001517538000T20190510152812R9620': '2019-05-10 11:21:08', 'P001326030500T20190514101008R5630': '2019-05-14 09:46:05', 'P001518885600T20190518101634R9320': '2019-05-17 16:17:33', 'P001518644100T20190513110951R1460': '2019-05-13 10:46:42', 'P001519408200T20190514113541R8670': '2019-05-14 11:14:43', 'P001519423900T20190514125610R5370': '2019-05-14 12:33:42', 'P001514918500T20190507171729R8710': '2019-05-07 16:48:44', 'P001517003900T20190508131603R1380': '2019-05-08 12:51:35', 'P001516391100T20190508115313R5590': '2019-05-08 11:31:57', 'P001519113100T20190516115436R7080': '2019-05-15 17:02:36', 'P001520190100T20190521150305R4220': '2019-05-21 14:30:00', 'P001516906900T20190510152122R8820': '2019-05-10 12:32:35', 'P001519286200T20190515113942R1331': '2019-05-15 11:19:37', 'P001518676100T20190512112939R6210': '2019-05-11 21:06:20', 'P001520075200T20190516150031R5960': '2019-05-16 14:41:27', 'P001517335000T20190510124457R9710': '2019-05-09 16:47:53', 'P001520714100T20190518111619R9720': '2019-05-18 10:55:30', 'P000861835800T20190507192619R5660': '2019-05-07 19:01:42', 'P001515441400T20190506102617R2640': '2019-05-06 10:09:05', 'P001517193700T20190510095230R7890': '2019-05-10 09:32:22', 'P001176819400T20190510173919R8300': '2019-05-10 17:16:58', 'P001093119700T20190506202614R3280': '2019-05-06 17:52:50', 'P001519216000T20190515104009R7430': '2019-05-15 10:18:26', 'P001511990400T20190508184421R9460': '2019-05-08 18:17:42', 'P001393040800T20190508105915R7130': '2019-05-08 10:32:35', 'P001517005300T20190513102308R1330': '2019-05-13 10:04:25', 'P001516755200T20190509091347R4760': '2019-05-09 08:55:52', 'P001519059400T20190513163007R9280': '2019-05-13 15:52:16', 'P001516473400T20190507151107R7510': '2019-05-07 11:33:49', 'P001517566800T20190510103437R4310': '2019-05-10 10:16:04', 'P000996662400T20190516153259R2310': '2019-05-16 15:05:00', 'P001519898800T20190516081918R2200': '2019-05-16 08:02:25', 'P001136957300T20190511093828R5050': '2019-05-11 09:20:40', 'P001519467900T20190514180650R2890': '2019-05-14 17:36:51', 'P000840039400T20190509144442R4950': '2019-05-09 14:17:00', 'P001517639600T20190515145147R2010': '2019-05-15 14:33:31', 'P001516846700T20190508153647R7270': '2019-05-08 15:09:22', 'P001520792500T20190519083012R9270': '2019-05-18 09:27:15', 'P001515857800T20190508104759R3350': '2019-05-08 10:25:13', 'P001520720200T20190521111919R9000': '2019-05-21 10:59:47', 'P001517874200T20190513112421R5200': '2019-05-13 11:02:43', 'P001520351600T20190518100046R9940': '2019-05-17 11:33:01', 'P000096806000T20190522105347R8120': '2019-05-22 10:32:37', 'P001516425700T20190509102803R4070': '2019-05-09 10:06:32', 'P001512026400T20190509094756R4960': '2019-05-09 09:25:24', 'P001515440500T20190520084319R1010': '2019-05-19 12:05:28', 'P000096870300T20190518100020R2680': '2019-05-17 16:24:08', 'P001519467700T20190521164240R8440': '2019-05-21 16:00:18', 'P001516738600T20190513093953R6050': '2019-05-13 09:20:35', 'P001517595300T20190510115555R1970': '2019-05-10 11:09:16', 'P001514537700T20190511122619R4140': '2019-05-11 12:04:28', 'P001514856500T20190507182348R9420': '2019-05-07 11:06:58', 'P001520766500T20190518100100R8710': '2019-05-17 15:53:42', 'P001516293000T20190509111051R8320': '2019-05-09 10:39:58', 'P001519398000T20190522090817R2580': '2019-05-22 08:46:59', 'P001517255000T20190510143627R7660': '2019-05-10 14:15:18', 'P001519672700T20190515172528R3950': '2019-05-15 16:56:01', 'P001224796100T20190522130308R6520': '2019-05-22 12:38:22', 'P001519448400T20190514105516R5990': '2019-05-14 10:34:46', 'P001519287700T20190514161717R2090': '2019-05-14 15:49:10', 'P001516836300T20190522165114R9780': '2019-05-22 16:17:30', 'P001034180400T20190518114602R3890': '2019-05-18 11:23:50', 'P001517304400T20190520112601R8830': '2019-05-20 11:03:38', 'P001167348900T20190520102551R9050': '2019-05-20 10:04:11', 'P001518421300T20190512101634R1220': '2019-05-12 09:55:13', 'P000873949200T20190516160508R8460': '2019-05-16 15:43:31', 'P001519732800T20190514155939R3570': '2019-05-14 15:34:38', 'P001517233700T20190509165837R9210': '2019-05-09 16:33:55', 'P001520347900T20190516172744R2090': '2019-05-16 17:03:18', 'P001515697700T20190509164625R7900': '2019-05-09 16:21:42', 'P001515760300T20190506202142R5040': '2019-05-06 08:16:32', 'P001516067000T20190506202523R7420': '2019-05-06 17:14:25', 'P001518799800T20190514151232R3270': '2019-05-14 14:45:30', 'P000919588500T20190514111750R4400': '2019-05-14 10:55:51', 'P001518710700T20190514173125R3160': '2019-05-14 17:01:54', 'P001518142100T20190510190425R1560': '2019-05-10 18:41:10', 'P001519785500T20190518123457R6670': '2019-05-17 10:21:53', 'P001520334900T20190516114718R5480': '2019-05-16 11:22:38', 'P001519305800T20190514104543R1951': '2019-05-14 10:25:55', 'P001517332000T20190511091829R6540': '2019-05-11 08:59:00', 'P001170465200T20190509123254R5770': '2019-05-09 12:11:02', 'P001518870900T20190513174406R3710': '2019-05-13 17:15:45', 'P001516256200T20190506112000R2260': '2019-05-06 10:57:53', 'P001518964200T20190514092147R6400': '2019-05-14 09:01:28', 'P001514179000T20190509080727R5110': '2019-05-08 14:45:22', 'P001516941800T20190513114433R3510': '2019-05-13 11:20:11', 'P001520785500T20190518101746R1930': '2019-05-17 17:44:26', 'P001518480500T20190521181612R9820': '2019-05-21 17:42:43', 'P001516225400T20190516100351R1320': '2019-05-16 09:41:03', 'P001516818000T20190509095202R3990': '2019-05-08 16:14:37', 'P001515842900T20190506100737R2971': '2019-05-06 09:46:56', 'P001517469700T20190514114651R8261': '2019-05-14 11:25:02', 'P001519640400T20190521085020R7560': '2019-05-21 08:31:21', 'P001515936100T20190508100251R4410': '2019-05-08 09:37:58', 'P001519701700T20190514154525R5490': '2019-05-14 15:15:55', 'P001444458100T20190508133201R7830': '2019-05-08 12:59:57', 'P001516599700T20190512093640R8130': '2019-05-12 09:22:39', 'P001445115200T20190507173437R2430': '2019-05-07 17:10:38', 'P001517721100T20190511103445R6570': '2019-05-11 10:00:22', 'P001518481200T20190514114514R7240': '2019-05-14 11:16:55', 'P001488820100T20190510181049R5930': '2019-05-10 17:49:25', 'P001517619800T20190510152223R6090': '2019-05-10 08:27:13', 'P001517673000T20190510160003R1250': '2019-05-10 15:30:16', 'P001517039000T20190513190341R8000': '2019-05-13 18:40:45', 'P001518279700T20190515094748R1960': '2019-05-15 09:30:45', 'P001519590200T20190516142106R1860': '2019-05-15 14:50:47', 'P001519241200T20190514170644R9530': '2019-05-14 16:43:18', 'P001518071600T20190510175531R5310': '2019-05-10 17:28:39', 'P001518166100T20190511083419R8760': '2019-05-11 08:17:18', 'P001518811500T20190518101734R2350': '2019-05-17 17:30:01', 'P001520591500T20190516102259R6970': '2019-05-16 09:57:55', 'P001149954800T20190508174721R8840': '2019-05-08 12:03:08', 'P001517198400T20190510170017R8590': '2019-05-10 16:35:30', 'P001078690000T20190512095231R7380': '2019-05-12 09:33:10', 'P001516014900T20190509095135R7260': '2019-05-08 16:07:55', 'P000883678500T20190508174456R7440': '2019-05-08 17:05:03', 'P001517417000T20190517152542R5080': '2019-05-17 15:02:59', 'P001515937800T20190511095617R2830': '2019-05-11 09:33:44', 'P001519294400T20190518121206R8270': '2019-05-17 15:16:23', 'P001512382500T20190511091457R3300': '2019-05-10 10:01:31', 'P001515745700T20190509120309R4720': '2019-05-09 11:36:48', 'P001517917200T20190510165629R7950': '2019-05-10 16:26:28', 'P001512824700T20190507143835R4150': '2019-05-07 14:14:21', 'P001519170200T20190515134423R3320': '2019-05-15 11:30:23', 'P001516030400T20190507182503R3540': '2019-05-07 09:39:53', 'P001517315800T20190510163916R2330': '2019-05-10 16:18:37', 'P001517314700T20190510133739R3270': '2019-05-09 17:10:24', 'P001515851600T20190506093137R1730': '2019-05-06 09:11:10', 'P001518949900T20190514121513R8421': '2019-05-14 11:41:54', 'P001519670700T20190516184531R9920': '2019-05-16 18:11:44', 'P001515759400T20190514172111R4130': '2019-05-14 16:56:07', 'P001517946800T20190511112317R1940': '2019-05-11 11:02:37', 'P001515466000T20190509162728R9810': '2019-05-09 16:02:06', 'P001519120000T20190516153545R6130': '2019-05-16 15:09:49', 'P001514470000T20190507191959R3430': '2019-05-07 18:55:49', 'P000847693500T20190506111636R5950': '2019-05-06 10:51:55', 'P001438409800T20190508152740R4760': '2019-05-08 12:10:42', 'P001516470900T20190510172127R1590': '2019-05-10 16:58:46', 'P001516592100T20190508144530R6420': '2019-05-08 14:24:48', 'P001518871600T20190513095652R6220': '2019-05-13 09:36:02', 'P000884022200T20190520130550R8040': '2019-05-20 12:42:53', 'P001516006100T20190516144828R7780': '2019-05-16 14:30:24', 'P001485743800T20190513113242R7720': '2019-05-13 11:10:50', 'P001511980700T20190513115011R9960': '2019-05-13 11:11:02', 'P000950642400T20190520101356R7410': '2019-05-20 09:53:27', 'P001519454200T20190518110519R2980': '2019-05-17 09:28:47', 'P001520163000T20190520171826R3940': '2019-05-20 16:48:52', 'P001519057700T20190517105320R6770': '2019-05-17 10:34:13', 'P001512708200T20190516150530R4000': '2019-05-15 15:19:15', 'P001517968300T20190516142047R8220': '2019-05-15 12:00:15', 'P001519327700T20190515100747R7110': '2019-05-15 09:47:39', 'P001518503900T20190515150736R1200': '2019-05-15 14:42:07', 'P001515215400T20190506202207R2950': '2019-05-06 08:11:10', 'P001518752600T20190514150616R4930': '2019-05-14 14:40:18', 'P001517329200T20190514164128R2380': '2019-05-14 16:16:25', 'P001517443000T20190509115424R2430': '2019-05-09 11:09:00', 'P001517019300T20190514185621R8250': '2019-05-14 18:22:19', 'P001519202100T20190515105440R3190': '2019-05-15 10:32:04', 'P001518696600T20190513104015R2600': '2019-05-13 10:17:04', 'P001514943200T20190507091536R8850': '2019-05-07 08:57:33', 'P001517303100T20190510092935R5390': '2019-05-10 09:09:49', 'P001517785400T20190516115937R9690': '2019-05-15 17:35:18', 'P001519892300T20190517170318R3230': '2019-05-17 16:29:54', 'P001516900400T20190510172919R5600': '2019-05-10 17:03:37', 'P001517852500T20190510150317R4940': '2019-05-10 14:37:15', 'P001212061600T20190516141535R7170': '2019-05-15 14:42:45', 'P001514321900T20190520104457R7340': '2019-05-20 08:05:25', 'P001516890500T20190513113553R8870': '2019-05-13 11:14:57', 'P001518890200T20190516115846R5740': '2019-05-15 16:28:52', 'P001516400500T20190509175835R5740': '2019-05-09 17:34:28', 'P001516462300T20190506151319R2860': '2019-05-06 14:49:22', 'P001520709300T20190520111843R7721': '2019-05-20 10:56:25', 'P001515842000T20190508151542R2610': '2019-05-08 14:49:58', 'P001519348300T20190514165917R1350': '2019-05-14 16:33:42', 'P001516848900T20190509095246R5020': '2019-05-08 11:08:08', 'P001516539600T20190507165411R9480': '2019-05-07 16:28:28', 'P001516774200T20190513145647R6230': '2019-05-13 14:29:09', 'P001516641000T20190509150925R4020': '2019-05-09 14:48:08', 'P001515176400T20190509145420R4580': '2019-05-09 14:28:02', 'P001518788900T20190516175554R7160': '2019-05-16 17:29:39', 'P001520659900T20190519104740R6340': '2019-05-18 09:10:55', 'P001519653800T20190516095350R9190': '2019-05-16 09:23:23', 'P001517839500T20190510181917R9920': '2019-05-10 17:58:20', 'P000894993800T20190513113556R1540': '2019-05-12 10:36:25', 'P001516565800T20190509183054R8301': '2019-05-09 18:02:00', 'P001520758900T20190520084417R7180': '2019-05-19 10:51:19', 'P001516749200T20190509101909R2040': '2019-05-09 09:56:54', 'P001519235700T20190518124652R8911': '2019-05-18 12:26:57', 'P001515511800T20190506163653R6000': '2019-05-06 16:10:13', 'P001262664500T20190511091521R1780': '2019-05-11 08:52:23', 'P001517072900T20190509095401R4450': '2019-05-09 09:30:47', 'P001519372000T20190516140936R9050': '2019-05-15 18:47:22', 'P001515807600T20190506165153R6560': '2019-05-06 16:27:10', 'P001519624500T20190516154506R6360': '2019-05-16 15:20:27', 'P001514919000T20190506104633R8110': '2019-05-06 10:16:38', 'P001518030800T20190514104123R1180': '2019-05-14 10:21:56', 'P001518765900T20190512105437R8670': '2019-05-12 10:29:44', 'P001519212000T20190522115033R1670': '2019-05-22 11:25:37', 'P001517761700T20190514133126R2070': '2019-05-14 13:12:17', 'P001516436200T20190508101655R9110': '2019-05-07 11:13:34', 'P001518169300T20190510171632R3660': '2019-05-10 16:50:59', 'P001516594100T20190508102602R4510': '2019-05-08 10:00:52', 'P001519222800T20190514110210R8510': '2019-05-14 10:40:24', 'P001511928400T20190506202548R7100': '2019-05-06 17:26:47', 'P001421253100T20190508094242R6110': '2019-05-08 09:10:58', 'P001519358900T20190518100824R1420': '2019-05-17 15:02:19', 'P001518122000T20190518140619R5630': '2019-05-17 17:07:38', 'P001124519700T20190513184904R1750': '2019-05-13 18:16:00', 'P001517220900T20190510092229R8820': '2019-05-10 09:02:23', 'P000981026800T20190510155712R8120': '2019-05-10 09:27:28', 'P001517336800T20190513110847R7960': '2019-05-12 10:10:09', 'P001516500500T20190508101636R2320': '2019-05-07 11:39:48', 'P001520156000T20190518102546R5930': '2019-05-18 10:01:52', 'P001520324100T20190518110632R3100': '2019-05-17 14:40:35', 'P001515853100T20190506145810R7110': '2019-05-06 14:37:43', 'P001516762500T20190508145534R6530': '2019-05-08 14:35:10', 'P001519896400T20190519081510R8230': '2019-05-18 09:03:53', 'P000953468100T20190510152600R7280': '2019-05-10 11:03:05', 'P001519710600T20190518101708R2020': '2019-05-17 16:35:28', 'P001516528800T20190507121250R8150': '2019-05-07 11:51:43', 'P001515488700T20190506104824R4450': '2019-05-06 10:30:41', 'P000096818200T20190516105403R6760': '2019-05-16 10:29:09', 'P001506705000T20190508113455R6530': '2019-05-07 10:23:36', 'P001516730300T20190521093147R5980': '2019-05-21 09:00:54', 'P001517161100T20190509122840R5300': '2019-05-09 12:01:30', 'P001518231500T20190521184916R9530': '2019-05-21 18:22:44', 'P001134078600T20190518114513R5630': '2019-05-17 09:53:10', 'P001520238100T20190517084532R7570': '2019-05-17 08:15:44', 'P001520594700T20190518114534R1060': '2019-05-17 09:34:47', 'P001520622700T20190521084738R7000': '2019-05-21 08:17:52', 'P001518817100T20190515131309R5010': '2019-05-15 12:47:27', 'P001517866800T20190513085101R4060': '2019-05-13 08:25:42', 'P001519423600T20190516145248R4100': '2019-05-15 16:03:56', 'P001519774700T20190516091536R9320': '2019-05-16 08:55:14', 'P001324003700T20190515134936R1870': '2019-05-15 11:36:25', 'P001510797500T20190507182527R6430': '2019-05-07 08:48:31', 'P001518167000T20190516115924R1160': '2019-05-15 17:22:15', 'P001515910200T20190506105853R4860': '2019-05-06 10:35:54', 'P001514553200T20190510180046R7020': '2019-05-10 17:39:22', 'P001519994000T20190516143245R2370': '2019-05-15 11:53:45', 'P001520139900T20190517104319R1540': '2019-05-17 10:24:03', 'P001515049900T20190507182438R2640': '2019-05-07 09:32:54', 'P001515162600T20190506085524R5450': '2019-05-06 08:38:35', 'P001517688800T20190510170826R2240': '2019-05-10 16:40:38', 'P001516559100T20190507165825R7800': '2019-05-07 16:34:21', 'P001517284400T20190511085719R7060': '2019-05-11 08:38:27', 'P000882892500T20190520184019R5320': '2019-05-20 18:11:37', 'P001518879800T20190513111745R3570': '2019-05-13 10:57:49', 'P001519163000T20190514165528R3690': '2019-05-14 16:26:12', 'P001517951700T20190510192338R7850': '2019-05-10 11:42:50', 'P001154217600T20190508121421R8930': '2019-05-08 11:53:06', 'P001240399600T20190506105004R8850': '2019-05-06 10:29:42', 'P001517189400T20190508101458R1700': '2019-05-08 09:49:03', 'P001517796100T20190516152618R5470': '2019-05-16 15:02:22', 'P001519928900T20190517094017R7530': '2019-05-17 09:21:50', 'P000937539900T20190514163107R3110': '2019-05-14 15:59:15', 'P001513009700T20190508134803R7910': '2019-05-08 13:24:58', 'P001516824100T20190520101755R9240': '2019-05-20 09:58:48', 'P001517755200T20190510152749R5280': '2019-05-10 11:15:16', 'P001517910300T20190511113216R2810': '2019-05-11 11:09:13', 'P001519326300T20190516120022R6630': '2019-05-15 14:08:38', 'P001519793400T20190521103207R1140': '2019-05-21 09:57:02', 'P001516786700T20190510184803R7370': '2019-05-10 18:20:18', 'P001516939500T20190510122639R6890': '2019-05-10 12:08:05', 'P000906084500T20190514175044R4150': '2019-05-14 17:21:08', 'P001516544300T20190508160318R1270': '2019-05-07 10:53:25', 'P001511342000T20190514153649R4990': '2019-05-14 15:09:03', 'P001517334300T20190510150640R7510': '2019-05-10 14:43:51', 'P001515236500T20190507145646R5640': '2019-05-07 14:35:02', 'P001515901400T20190506104212R8380': '2019-05-06 09:56:38', 'P001518063900T20190519104659R9810': '2019-05-18 08:13:01', 'P001517179900T20190510184021R5430': '2019-05-10 18:14:26', 'P001076984300T20190516082654R3960': '2019-05-15 12:26:52', 'P001219906800T20190514101513R3860': '2019-05-14 09:50:47', 'P001516924700T20190511122026R9720': '2019-05-11 11:54:01', 'P001517863600T20190513110800R4460': '2019-05-12 09:49:58', 'P001517174400T20190510093630R1290': '2019-05-10 09:20:48', 'P001517408400T20190511114721R6790': '2019-05-11 11:21:06', 'P001520711400T20190518101951R9350': '2019-05-18 09:53:46', 'P001520351700T20190518100007R2670': '2019-05-17 16:52:25', 'P001517925500T20190511090230R2140': '2019-05-11 08:44:07', 'P001425273300T20190520200128R6460': '2019-05-20 19:29:53', 'P001516637800T20190514122849R3840': '2019-05-14 12:07:17', 'P001516468700T20190509094906R3720': '2019-05-08 15:32:06', 'P001518661100T20190513154117R5160': '2019-05-13 15:18:36', 'P001519471300T20190520103045R6350': '2019-05-20 10:10:35', 'P001517764000T20190510154256R8690': '2019-05-10 15:21:49', 'P001518117600T20190510180534R2590': '2019-05-10 17:43:56', 'P001516989400T20190509104826R9660': '2019-05-09 10:22:23', 'P001519911300T20190516101306R8170': '2019-05-16 09:50:46', 'P001051294100T20190518100114R4610': '2019-05-17 16:11:31', 'P001516849400T20190508151632R6140': '2019-05-08 14:57:47', 'P001442713500T20190521105006R4720': '2019-05-21 10:25:47', 'P001517127100T20190508192017R4750': '2019-05-08 18:54:32', 'P001518747400T20190514123949R6410': '2019-05-14 12:14:27', 'P001515549800T20190509144926R8160': '2019-05-09 14:22:29', 'P001520054200T20190520095549R1780': '2019-05-20 09:37:01', 'P001520125400T20190516164239R5910': '2019-05-16 16:04:26', 'P001519699900T20190516101155R5330': '2019-05-16 09:50:45', 'P001100332200T20190522131459R3060': '2019-05-22 12:46:29', 'P001217595300T20190522083919R5920': '2019-05-22 08:20:57', 'P001518216600T20190514092757R9550': '2019-05-14 09:09:16', 'P001516930000T20190510152911R1970': '2019-05-10 11:36:36', 'P001516077000T20190516184308R9011': '2019-05-16 18:05:12', 'P001518121800T20190511084816R3950': '2019-05-11 08:30:29', 'P001519740900T20190516161141R8670': '2019-05-15 14:56:11', 'P001322402800T20190519104622R5080': '2019-05-18 08:19:57', 'P001445686400T20190519093231R5970': '2019-05-19 09:16:12', 'P000838628100T20190510152330R8800': '2019-05-10 12:21:26', 'P001518874800T20190514155526R9370': '2019-05-14 15:22:34', 'P001514283100T20190506202236R6430': '2019-05-06 09:05:24', 'P001517683900T20190518110544R1260': '2019-05-17 08:45:42', 'P001519271000T20190514112827R3610': '2019-05-14 11:08:28', 'P001281758500T20190514093544R3410': '2019-05-14 09:14:48', 'P001520389300T20190517091207R1970': '2019-05-17 08:53:42', 'P000883700600T20190518103401R3430': '2019-05-18 10:11:34', 'P001511049200T20190510152534R9260': '2019-05-10 11:49:58', 'P001518787400T20190513161001R3161': '2019-05-13 15:40:33', 'P001519582500T20190521104452R6210': '2019-05-21 10:14:46', 'P001520186100T20190518114616R5080': '2019-05-17 16:46:48', 'P001517308400T20190509131306R1470': '2019-05-09 12:53:53', 'P001520208200T20190516172241R5640': '2019-05-16 16:56:54', 'P001520195900T20190516174813R2130': '2019-05-16 17:23:43', 'P001519442100T20190516083423R9840': '2019-05-16 08:17:49', 'P001519218900T20190514192333R4930': '2019-05-14 18:43:05', 'P001518141000T20190514124748R4410': '2019-05-14 12:25:28', 'P001520122500T20190520145012R1630': '2019-05-20 14:26:18', 'P001516247300T20190506181023R7090': '2019-05-06 17:40:11', 'P001516886200T20190508151038R9700': '2019-05-08 14:44:13', 'P001515816600T20190507172941R7030': '2019-05-07 17:03:08', 'P001518521400T20190514111545R1970': '2019-05-14 10:54:39', 'P001517872600T20190510185221R3620': '2019-05-10 18:26:01', 'P001520653000T20190519104830R4610': '2019-05-18 09:18:01', 'P001520192800T20190516182704R2740': '2019-05-16 17:36:24', 'P001516488300T20190508092132R9750': '2019-05-08 09:04:39', 'P001516406400T20190513171948R3250': '2019-05-13 15:15:34'}
    os.remove('./a.txt')
    for case in cases:
        with open('a.txt', 'a+')as af:
            af.write(f"update cases set study_datetime = '{cases[case]}' where case_num = '{case}';\n")